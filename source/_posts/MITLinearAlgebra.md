---
title: MITLinearAlgebra
mathjax: true
date: 2020-09-27 09:04:38
tags:
- 线性代数
categories: 数学
---

MIT Prof. Gilbert Strang 的公开课，讲解线性代数的知识，这里做一个小笔记，简单记录每个课堂里的重点。
- 方程组的几何解释
- 矩阵的消元和LU分解
- 列空间与零空间
- 求解Ax=b

<!-- more -->

完整链接:
{% post_link MITLinearAlgebra %}
{% post_link MITLinearAlgebra-2 %}
{% post_link MITLinearAlgebra-3 %}


## 方程组的几何解释

以三维的方程组为例(随便写的)

$$

5x + 4y -  z = 0\\
2x +  y - 3z = 1\\
3x - 4y - 2z =-2\\
$$

$$
A=
\begin{pmatrix}

5 & 4& -1\\
2 & 1& -3\\
3 &-4& -2\\
\end{pmatrix}

$$

- row picture：逐行解释，满足每行方程的点在三维空间里能够形成一个二维的平面，三个平面的交点就是满足方程组的解
- column picture：把系数矩阵A视作三个列向量，原方程视作三个三维列向量的线性组合

$$

x\begin{bmatrix}
5&\\
2&\\
3
\end{bmatrix}

+y\begin{bmatrix}
4&\\
1&\\
-4
\end{bmatrix}

+z\begin{bmatrix}
-1&\\
-3&\\
-2
\end{bmatrix}

$$

$\color{red}{矩阵\times列向量=列向量}$

明显，以列向量线性组合的方式更简洁，更符合直观认识。

## 矩阵消元

讲解的内容为高斯消元法，思路很简单，所设计到的都是**行变换**

消元：
1. 如果(1,1)元素非0，将其作为第一列主元，保留第一行不变
2. 通过矩阵行加法，将第一列其余元素变为0
3. 查看第二列，若(2,2)元素为0，寻找非零主元pivot，找到后将其所在行与第二行交换，使用矩阵行加法将其余行的第二列元素变为0
4. 重复上述消元步骤，直至将A变化为上三角矩阵U

回代：
1. 对$Ax=b$等式右侧的$b$列向量运用同样的上述变换
2. 先计算出最后一维的解，再依次求解所有的变量解


那么上述的行变换过程如何用矩阵表示呢？

需要首先明确的是，行变换需要的是左乘，与上一节右乘列向量得到列向量类似，有

$\color{red}{行向量\times矩阵=行向量}$

一个行向量的左乘就代表一次矩阵$A$行向量的线性组合，产生一个新的行向量。每一次每一列的消元，就是n次的矩阵A行向量的线性组合，形成的是$n$个新的行向量。

因此，每一列的消元都是左乘一个跟$A$一样维度的方阵，如果对上面的三维矩阵$A$，将方阵的下标写成每次要消去的第一个元素的代号，那么可以将两次消元的方阵写作$E_{(2,1)}和E_{(3,2)}$，他们的乘积$E$就是这次表示消元所需要的矩阵。

$$
A=
\begin{pmatrix}

5 & 4& -1\\
2 & 1& -3\\
3 &-4& -2\\
\end{pmatrix}

$$

下面简要说明其中一个方阵的书写思路，也就是线性组合的思路

$$
E_{(2,1)}第一行负责计算新矩阵的第一行\\保持不变所以是{1，0，0},以此类推\\新第二行是旧的第二行减去0.4倍的第一行\\新第三行是旧第三行减去0.6倍的旧第一行\\
E_{(2,1)}=
\begin{pmatrix}

1 & 0&  0\\
-0.4 & 1& 0\\
-0.6 &0& 1\\
\end{pmatrix}

$$

上述是行变换的矩阵，如果需要计算列变换对应的矩阵，和上面的思路是一致的，只不过矩阵变成了右乘。

***矩阵消元法也会有失败的时候，也就是最后发现某一列找不到主元元素了，即剩余的元素都是0***

*一般不会去直接计算E，而是去计算各方阵的逆*（原因好像没解释）

## 矩阵的乘法和逆矩阵

### 乘法

$$A\times B=C
$$
矩阵乘法的四种方法：
1. 点乘对应A行B列得到C中的某一个元素
2. A中列向量的线性组合，A分别与B中每个列向量相乘
3. B中行向量的线性组合，B分别与A中每个行向量相乘
4. A和B中对应列对应行分别的乘积，得到若干个矩阵，矩阵相加为结果（一列乘一行得到一个矩阵，很特殊，每一行和每一列都是线性相关）

矩阵还可以分块乘积


### 逆矩阵
这里讨论的都是方阵的逆矩阵，方阵的逆矩阵左右乘都可以，非方阵的不可以

可逆的，非奇异的
invertible，nonsingular

**什么样的方阵是不可逆的：**

- 行列式为0的矩阵
- 矩阵的行向量或者列向量存在线性相关
- 存在非零向量$x$，使得$Ax=0$成立

>第三个的简单证明，使用反证法，若存在$A^{-1}$，则若$Ax=0$成立，那么$A^{-1}Ax=Ix=0 \Rightarrow x=0$，矛盾

**使用Gauss-Jordan思路求逆矩阵：**
1. 将原矩阵$A$与单位矩阵$I$组合形成增广矩阵$[A|I]$
2. 对增广矩阵进行高斯消元，使用行变换方法，将左半部分转化为上三角矩阵
3. 使用jordan思路，反向行变换，将上三角矩阵变成单位阵，则此时右半部分即为$A^{-1}$


## 矩阵的LU分解

本节内容：
- 逆矩阵和转置矩阵的基本知识
- 如何理解A=LU分解
- A的高斯消去需要多少步骤
- permutation置换矩阵是啥以及它的性质

### 逆矩阵和转置的一些基本知识

$$

(AB)^{-1} = B^{-1}A^{-1} \\

(AB)^{T} = B^{T}A^{T}  \\
(A^{T})^{-1} = (A^{-1})^{T} \\

$$

### LU分解

>前提：
矩阵是方阵（LU分解主要是针对方阵）；
矩阵是可逆的，也就是该矩阵是满秩矩阵，每一行都是独立向量；
消元过程中没有0主元出现，也就是消元过程中不能出现行交换的初等变换。


意义：单次LU分解量不小，但是可以反复利用LU
>看起来比高斯消元经历了更多的步骤，那为什么又说LU分解更快呢？在实践中，b是输出，输出又经常变动，从Ax = b频繁地变成Ax = b’，此时高斯消元就需要全部重新计算（高斯消元用增广矩阵消元，变化过程是[A, b]→[U, b’]），这对大型矩阵来说及其耗时。反观LU分解，因为它不依赖于b，所以计算一次后就可以存储U和L-1，在输出变化后也只是需要简单的相乘。实际上，由于L已经是整理过的斜对角全是1的下三角矩阵，所以用高斯-诺当消元法对L求逆非常简单。


$$
EA = U\\
L = E^{-1}\\
A = LU \\
$$

U代表upper上三角矩阵，L代表lower下三角矩阵。
如果将U继续分解为DU,可以得到新的分解LDU，下三角乘对角乘上三角。

$$

A = LDU

$$

推荐LU分解的原因在于，利用单个的消元矩阵$E_{2,1},E_{3,1}$这种直接去求$E$其实很麻烦，因为会涉及到复杂的矩阵乘法运算，后续的步骤会受到前序消元的影响，不能直接通过理解写出$E$。

而L矩阵因为是逆矩阵的乘积，顺序从最后一行返回第一行，每一个都不会受到前序矩阵的影响，因此能够直接把单个的消元矩阵的元素拼接到一起形成一个下三角矩阵。

>如果没有行交换操作，则消元矩阵的因子可以直接写入矩阵L。没有多余的交叉项出现是LU分解要优于EA=U这种形式的原因之一。

### 消元法的计算量

将线性组合每进行一次行元素的乘和加减作为一次操作，例如将第一行某一个元素乘以两倍，再用第二行对应元素减去，这个算一次操作。

第一列除了第一个元素外消成0，这个流程总共需要大约$n^2$次操作，一个矩阵完成消元需要$\sum^{N}_{i} i^2$次，拿微积分公式近似计算一下发现需要$1/3N^{3}$次计算操作。

等号右侧向量b的行变换大致需要nxn次运算。


### 置换矩阵

表示row exchange行交换的矩阵，行交换在高斯消元法里用于寻找主元，

直接用单位矩阵的各种行交换矩阵就可以表示出置换矩阵的样子。

对于n阶的方阵，总共有n！个置换矩阵，置换矩阵的逆矩阵也是置换矩阵，同时也是置换矩阵的转置矩阵。即如果置换矩阵是对称矩阵，则其是三矩阵一体，原矩阵=逆矩阵=转置矩阵。

## 转置-置换-向量空间

symmetric matrix

$$

M^{T} = M

$$

任何转置矩阵乘以本身得到的都是对称矩阵$R^{T}R=(R^{T}R)^{T}$

$R^{T}R$ is always symmetric

### 向量空间

对于其中向量进行线性计算（加法和数乘）封闭（closed）的空间$R^{n}$显然是向量空间
0向量必须是向量空间中的一部分
向量子空间是向量空间中的一部分，本质上感觉是对n-1维基向量重新展开的结果，比如在$R^{2}$中过零点的直线。（不，这不一样，不是一维的）

**subspace of $R^{2}$**:

- $R^{2}$
- any line through origin
- zero vector only

比较特殊的是零向量空间，这个空间里只有0向量，所以线性计算都能成立，是个单矢量空间

### 列空间和零空间

用矩阵中的列向量作为基向量，形成spin得到的子空间称为列空间C（A），column space

两个向量子空间，P和L，那么两个子空间的并集并非向量空间，因为对加法不封闭。两个空间的交集则是子空间，因为所包含的向量无论做加法还是数乘都一定在这个交集里面。
$$

A=
\begin{pmatrix}

1 & 1& 2\\
2 & 1& 3\\
3 & 1& 4\\
4 & 1& 5\\ 
\end{pmatrix}

$$

对于$Ax=b$，当b属于A的列空间时有解。
观察矩阵A，发现第三列是前两列的线性组合，这里将前两列称作主列，并说这三列是线性相关的，去掉非主列不影响列空间的规模。
#### 零空间
null space of A： add solutions to $Ax=0$使得方程成立的解组成的空间是零空间
- nullspace certainly contains zero零空间包含零向量，的确是个向量空间
- 对于A矩阵来说，零空间得到了一条直线 [c,c-c]
- a line in $R^3$
- 零空间是向量空间的检验，和向量与数乘后向量依然满足$Ax=0$的方程，证明非常明显$A(w+v)=0, A(kw)=0$
#### 解空间？
？？？对于$Ax=b,b\ne0$这个方程的解不构成向量空间，最容易证明的是这个解里面不包含0。解是一个不通过零点的直线。

### 解Ax=0主变量和特解

$$
A=
\begin{pmatrix}
1 & 2& 2&2 \\
2 & 4& 6&8 \\
3 & 6& 8&10 \\
\end{pmatrix}
$$
随着消元法进行，零空间不改变，改变了列空间。
$$
得到了一个echelon form
staircase form阶梯形矩阵
U=
\begin{pmatrix}
1 & 2& 2&2 \\
0 & 0& 2&4 \\
0 & 0& 0&0 \\
\end{pmatrix}
$$
这里引入了**Rank**的定义：表示Ux=0中阶梯型矩阵U主元（**pivot variable**）的个数。主元所在的列称作主列（**pivot column**），其余列为自由列（**free column**），自由列对应的变量元素（**free variable**）可以自由的取值，我们要求解的只有主元的值。

- **任意对free variable赋值可以得到special solution特解**，特解的线性组合就是null space。
- 每一个自由变量对应一个特解。
- 自由变量有多少呢？自由变量=列数n-主元r，r个主变量代表只有r个方程起作用，那么（n-r）个自由变量可以得到（n-r）个特解。

#### 进一步简化

矩阵R = Reduced row echelon matrix
做向上消元，使得主元上下都是0，主元化1
$$
R=
\begin{pmatrix}
1 & 2& 0&-2 \\
0 & 0& 1&2 \\
0 & 0& 0&0 \\
\end{pmatrix}
$$
包含所有信息的最简形式，所有主元为1，形成一个单位矩阵。$Rx=0$仍然是零空间的向量。
移动R中列，得到
$$
\begin{pmatrix}
I&F\\
0&0\\
\end{pmatrix}
$$
N零空间矩阵nullspace matrix
为了$RN=0$
$$
N=
\begin{pmatrix}
-F\\
I\\
\end{pmatrix}
$$
N就是其中的一个特解，这里可以清晰看到通过简化行矩阵，可以清楚的写出零空间特解。
*这里有点迷惑，因为感觉这样会造成解元素顺序的混乱。。。*

## 求解Ax=b，complete solution

$$
Augmented Matrix=
\begin{pmatrix}
1& 2& 2& 2& b1\\
2& 4& 6& 8& b2\\
3& 6& 8& 10& b3\\
\end{pmatrix}
$$
为了有解b1，b2，b3需要满足条件。
### 可解性
如何可以让Ax=b有解？
- 仅当b属于C（A）的时候有解
- 如何A的**行向量组合**得到了0，那么b的组合也要等于0

求解过程：
1. 找出一个特解
   1. 将自由向量置0
   2. 求解Ax=b中的主元素
2. 可以加上nullspace中的任意向量
3. 最终结果就是全解
（与线性微分方程惊人一致，这种形式存在于各种线性方程中）
$X_{complete}=X_{p}+c_{1}Xn_{1}+c_{2}Xn_{2}$
零空间是一个二维向量子空间，但是x的全解的空间不是向量空间，因为不过0点。

**扩展思考可解性**
m*n matrix A of rank r
know:
- $r\le m$
- $r\le n$

讨论满秩情况
**full column rank**
没有自由向量，全都是主元，就意味着没有零空间的特解。N（A）只有零向量。$Ax=b$的解只有一个特解$X_{unique}$。

*列满秩情况如果解存在则解唯一*
b在A列空间中的时候有解

**full row rank** 
- 对任意b都会有解，对于b没有要求，每一行都有主元，*不会有零行*。
- 自由变量数目为n-m个free variables

1. **r=n=m**
满秩方阵
R = I 有唯一解

2. r=n < m
R = [I;0] 没有解或者唯一解

3. r=m < n
R = [I F] 有解 I和F会交叉出现，无穷多解

4. r < m, r < n
R = [I F; 0 0]
0或者无穷多解

是否有解在于Ax=b的特解是否存在，而是否有无穷解则看零空间是否只含零向量（是否有自由变量）。

**Rank里包含了所有解数量的信息**

{% post_link MITLinearAlgebra-2 %}
